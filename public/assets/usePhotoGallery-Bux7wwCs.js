const __vite__fileDeps=["assets/web-DAZOWlIc.js","assets/index-DSsP63NG.js","assets/index-D1UOsCVC.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{_ as me,r as se,$ as pe,a0 as J,a1 as X,a2 as Y}from"./index-DSsP63NG.js";/*! Capacitor: https://capacitorjs.com/ - MIT License */const he=t=>{const e=new Map;e.set("web",{name:"web"});const a=t.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:e},n=(i,o)=>{a.platforms.set(i,o)},r=i=>{a.platforms.has(i)&&(a.currentPlatform=a.platforms.get(i))};return a.addPlatform=n,a.setPlatform=r,a},ge=t=>t.CapacitorPlatforms=he(t),ie=ge(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});ie.addPlatform;ie.setPlatform;var _;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(_||(_={}));class R extends Error{constructor(e,a,n){super(e),this.message=e,this.code=a,this.data=n}}const be=t=>{var e,a;return t!=null&&t.androidBridge?"android":!((a=(e=t==null?void 0:t.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||a===void 0)&&a.bridge?"ios":"web"},we=t=>{var e,a,n,r,i;const o=t.CapacitorCustomPlatform||null,s=t.Capacitor||{},c=s.Plugins=s.Plugins||{},l=t.CapacitorPlatforms,f=()=>o!==null?o.name:be(t),h=((e=l==null?void 0:l.currentPlatform)===null||e===void 0?void 0:e.getPlatform)||f,y=()=>h()!=="web",E=((a=l==null?void 0:l.currentPlatform)===null||a===void 0?void 0:a.isNativePlatform)||y,A=d=>{const u=q.get(d);return!!(u!=null&&u.platforms.has(h())||F(d))},D=((n=l==null?void 0:l.currentPlatform)===null||n===void 0?void 0:n.isPluginAvailable)||A,S=d=>{var u;return(u=s.PluginHeaders)===null||u===void 0?void 0:u.find(k=>k.name===d)},F=((r=l==null?void 0:l.currentPlatform)===null||r===void 0?void 0:r.getPluginHeader)||S,W=d=>t.console.error(d),U=(d,u,k)=>Promise.reject("".concat(k,' does not have an implementation of "').concat(u,'".')),q=new Map,le=(d,u={})=>{const k=q.get(d);if(k)return console.warn('Capacitor plugin "'.concat(d,'" already registered. Cannot register plugins twice.')),k.proxy;const L=h(),O=F(d);let w;const de=async()=>(!w&&L in u?w=typeof u[L]=="function"?w=await u[L]():w=u[L]:o!==null&&!w&&"web"in u&&(w=typeof u.web=="function"?w=await u.web():w=u.web),w),ue=(m,p)=>{var b,v;if(O){const P=O==null?void 0:O.methods.find(g=>p===g.name);if(P)return P.rtype==="promise"?g=>s.nativePromise(d,p.toString(),g):(g,j)=>s.nativeCallback(d,p.toString(),g,j);if(m)return(b=m[p])===null||b===void 0?void 0:b.bind(m)}else{if(m)return(v=m[p])===null||v===void 0?void 0:v.bind(m);throw new R('"'.concat(d,'" plugin is not implemented on ').concat(L),_.Unimplemented)}},B=m=>{let p;const b=(...v)=>{const P=de().then(g=>{const j=ue(g,m);if(j){const I=j(...v);return p=I==null?void 0:I.remove,I}else throw new R('"'.concat(d,".").concat(m,'()" is not implemented on ').concat(L),_.Unimplemented)});return m==="addListener"&&(P.remove=async()=>p()),P};return b.toString=()=>"".concat(m.toString(),"() { [capacitor code] }"),Object.defineProperty(b,"name",{value:m,writable:!1,configurable:!1}),b},N=B("addListener"),z=B("removeListener"),fe=(m,p)=>{const b=N({eventName:m},p),v=async()=>{const g=await b;z({eventName:m,callbackId:g},p)},P=new Promise(g=>b.then(()=>g({remove:v})));return P.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await v()},P},G=new Proxy({},{get(m,p){switch(p){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return O?fe:N;case"removeListener":return z;default:return B(p)}}});return c[d]=G,q.set(d,{name:d,proxy:G,platforms:new Set([...Object.keys(u),...O?[L]:[]])}),G},ce=((i=l==null?void 0:l.currentPlatform)===null||i===void 0?void 0:i.registerPlugin)||le;return s.convertFileSrc||(s.convertFileSrc=d=>d),s.getPlatform=h,s.handleError=W,s.isNativePlatform=E,s.isPluginAvailable=D,s.pluginMethodNoop=U,s.registerPlugin=ce,s.Exception=R,s.DEBUG=!!s.DEBUG,s.isLoggingEnabled=!!s.isLoggingEnabled,s.platform=s.getPlatform(),s.isNative=s.isNativePlatform(),s},ye=t=>t.Capacitor=we(t),H=ye(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),M=H.registerPlugin;H.Plugins;class V{constructor(e){this.listeners={},this.retainedEventArguments={},this.windowListeners={},e&&(console.warn('Capacitor WebPlugin "'.concat(e.name,'" config object was deprecated in v3 and will be removed in v4.')),this.config=e)}addListener(e,a){let n=!1;this.listeners[e]||(this.listeners[e]=[],n=!0),this.listeners[e].push(a);const i=this.windowListeners[e];i&&!i.registered&&this.addWindowListener(i),n&&this.sendRetainedArgumentsForEvent(e);const o=async()=>this.removeListener(e,a);return Promise.resolve({remove:o})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,a,n){const r=this.listeners[e];if(!r){if(n){let i=this.retainedEventArguments[e];i||(i=[]),i.push(a),this.retainedEventArguments[e]=i}return}r.forEach(i=>i(a))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,a){this.windowListeners[a]={registered:!1,windowEventName:e,pluginEventName:a,handler:n=>{this.notifyListeners(a,n)}}}unimplemented(e="not implemented"){return new H.Exception(e,_.Unimplemented)}unavailable(e="not available"){return new H.Exception(e,_.Unavailable)}async removeListener(e,a){const n=this.listeners[e];if(!n)return;const r=n.indexOf(a);this.listeners[e].splice(r,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const a=this.retainedEventArguments[e];a&&(delete this.retainedEventArguments[e],a.forEach(n=>{this.notifyListeners(e,n)}))}}const Q=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Z=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class ve extends V{async getCookies(){const e=document.cookie,a={};return e.split(";").forEach(n=>{if(n.length<=0)return;let[r,i]=n.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");r=Z(r).trim(),i=Z(i).trim(),a[r]=i}),a}async setCookie(e){try{const a=Q(e.key),n=Q(e.value),r="; expires=".concat((e.expires||"").replace("expires=","")),i=(e.path||"/").replace("path=",""),o=e.url!=null&&e.url.length>0?"domain=".concat(e.url):"";document.cookie="".concat(a,"=").concat(n||"").concat(r,"; path=").concat(i,"; ").concat(o,";")}catch(a){return Promise.reject(a)}}async deleteCookie(e){try{document.cookie="".concat(e.key,"=; Max-Age=0")}catch(a){return Promise.reject(a)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const a of e)document.cookie=a.replace(/^ +/,"").replace(/=.*/,"=;expires=".concat(new Date().toUTCString(),";path=/"))}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}M("CapacitorCookies",{web:()=>new ve});const Pe=async t=>new Promise((e,a)=>{const n=new FileReader;n.onload=()=>{const r=n.result;e(r.indexOf(",")>=0?r.split(",")[1]:r)},n.onerror=r=>a(r),n.readAsDataURL(t)}),Ee=(t={})=>{const e=Object.keys(t);return Object.keys(t).map(r=>r.toLocaleLowerCase()).reduce((r,i,o)=>(r[i]=t[e[o]],r),{})},Le=(t,e=!0)=>t?Object.entries(t).reduce((n,r)=>{const[i,o]=r;let s,c;return Array.isArray(o)?(c="",o.forEach(l=>{s=e?encodeURIComponent(l):l,c+="".concat(i,"=").concat(s,"&")}),c.slice(0,-1)):(s=e?encodeURIComponent(o):o,c="".concat(i,"=").concat(s)),"".concat(n,"&").concat(c)},"").substr(1):null,Ce=(t,e={})=>{const a=Object.assign({method:t.method||"GET",headers:t.headers},e),r=Ee(t.headers)["content-type"]||"";if(typeof t.data=="string")a.body=t.data;else if(r.includes("application/x-www-form-urlencoded")){const i=new URLSearchParams;for(const[o,s]of Object.entries(t.data||{}))i.set(o,s);a.body=i.toString()}else if(r.includes("multipart/form-data")||t.data instanceof FormData){const i=new FormData;if(t.data instanceof FormData)t.data.forEach((s,c)=>{i.append(c,s)});else for(const s of Object.keys(t.data))i.append(s,t.data[s]);a.body=i;const o=new Headers(a.headers);o.delete("content-type"),a.headers=o}else(r.includes("application/json")||typeof t.data=="object")&&(a.body=JSON.stringify(t.data));return a};class Ae extends V{async request(e){const a=Ce(e,e.webFetchExtra),n=Le(e.params,e.shouldEncodeUrlParams),r=n?"".concat(e.url,"?").concat(n):e.url,i=await fetch(r,a),o=i.headers.get("content-type")||"";let{responseType:s="text"}=i.ok?e:{};o.includes("application/json")&&(s="json");let c,l;switch(s){case"arraybuffer":case"blob":l=await i.blob(),c=await Pe(l);break;case"json":c=await i.json();break;case"document":case"text":default:c=await i.text()}const f={};return i.headers.forEach((h,y)=>{f[y]=h}),{data:c,headers:f,status:i.status,url:i.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}M("CapacitorHttp",{web:()=>new Ae});var C;(function(t){t.Prompt="PROMPT",t.Camera="CAMERA",t.Photos="PHOTOS"})(C||(C={}));var $;(function(t){t.Rear="REAR",t.Front="FRONT"})($||($={}));var K;(function(t){t.Uri="uri",t.Base64="base64",t.DataUrl="dataUrl"})(K||(K={}));class oe extends V{async getPhoto(e){return new Promise(async(a,n)=>{if(e.webUseInput||e.source===C.Photos)this.fileInputExperience(e,a,n);else if(e.source===C.Prompt){let r=document.querySelector("pwa-action-sheet");r||(r=document.createElement("pwa-action-sheet"),document.body.appendChild(r)),r.header=e.promptLabelHeader||"Photo",r.cancelable=!1,r.options=[{title:e.promptLabelPhoto||"From Photos"},{title:e.promptLabelPicture||"Take Picture"}],r.addEventListener("onSelection",async i=>{i.detail===0?this.fileInputExperience(e,a,n):this.cameraExperience(e,a,n)})}else this.cameraExperience(e,a,n)})}async pickImages(e){return new Promise(async(a,n)=>{this.multipleFileInputExperience(a,n)})}async cameraExperience(e,a,n){if(customElements.get("pwa-camera-modal")){const r=document.createElement("pwa-camera-modal");r.facingMode=e.direction===$.Front?"user":"environment",document.body.appendChild(r);try{await r.componentOnReady(),r.addEventListener("onPhoto",async i=>{const o=i.detail;o===null?n(new R("User cancelled photos app")):o instanceof Error?n(o):a(await this._getCameraPhoto(o,e)),r.dismiss(),document.body.removeChild(r)}),r.present()}catch(i){this.fileInputExperience(e,a,n)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),this.fileInputExperience(e,a,n)}fileInputExperience(e,a,n){let r=document.querySelector("#_capacitor-camera-input");const i=()=>{var o;(o=r.parentNode)===null||o===void 0||o.removeChild(r)};r||(r=document.createElement("input"),r.id="_capacitor-camera-input",r.type="file",r.hidden=!0,document.body.appendChild(r),r.addEventListener("change",o=>{const s=r.files[0];let c="jpeg";if(s.type==="image/png"?c="png":s.type==="image/gif"&&(c="gif"),e.resultType==="dataUrl"||e.resultType==="base64"){const l=new FileReader;l.addEventListener("load",()=>{if(e.resultType==="dataUrl")a({dataUrl:l.result,format:c});else if(e.resultType==="base64"){const f=l.result.split(",")[1];a({base64String:f,format:c})}i()}),l.readAsDataURL(s)}else a({webPath:URL.createObjectURL(s),format:c}),i()}),r.addEventListener("cancel",o=>{n(new R("User cancelled photos app")),i()})),r.accept="image/*",r.capture=!0,e.source===C.Photos||e.source===C.Prompt?r.removeAttribute("capture"):e.direction===$.Front?r.capture="user":e.direction===$.Rear&&(r.capture="environment"),r.click()}multipleFileInputExperience(e,a){let n=document.querySelector("#_capacitor-camera-input-multiple");const r=()=>{var i;(i=n.parentNode)===null||i===void 0||i.removeChild(n)};n||(n=document.createElement("input"),n.id="_capacitor-camera-input-multiple",n.type="file",n.hidden=!0,n.multiple=!0,document.body.appendChild(n),n.addEventListener("change",i=>{const o=[];for(let s=0;s<n.files.length;s++){const c=n.files[s];let l="jpeg";c.type==="image/png"?l="png":c.type==="image/gif"&&(l="gif"),o.push({webPath:URL.createObjectURL(c),format:l})}e({photos:o}),r()}),n.addEventListener("cancel",i=>{a(new R("User cancelled photos app")),r()})),n.accept="image/*",n.click()}_getCameraPhoto(e,a){return new Promise((n,r)=>{const i=new FileReader,o=e.type.split("/")[1];a.resultType==="uri"?n({webPath:URL.createObjectURL(e),format:o,saved:!1}):(i.readAsDataURL(e),i.onloadend=()=>{const s=i.result;a.resultType==="dataUrl"?n({dataUrl:s,format:o,saved:!1}):n({base64String:s.split(",")[1],format:o,saved:!1})},i.onerror=s=>{r(s)})})}async checkPermissions(){if(typeof navigator>"u"||!navigator.permissions)throw this.unavailable("Permissions API not available in this browser");try{return{camera:(await window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch(e){throw this.unavailable("Camera permissions are not available in this browser")}}async requestPermissions(){throw this.unimplemented("Not implemented on web.")}async pickLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}async getLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}}new oe;const ee=M("Camera",{web:()=>new oe});var te;(function(t){t.Documents="DOCUMENTS",t.Data="DATA",t.Library="LIBRARY",t.Cache="CACHE",t.External="EXTERNAL",t.ExternalStorage="EXTERNAL_STORAGE"})(te||(te={}));var ae;(function(t){t.UTF8="utf8",t.ASCII="ascii",t.UTF16="utf16"})(ae||(ae={}));const re=M("Filesystem",{web:()=>me(()=>import("./web-DAZOWlIc.js"),__vite__mapDeps([0,1,2])).then(t=>new t.FilesystemWeb)}),T=se(""),x=se([]);function ne(t,e="",a=512){const n=atob(t),r=[];for(let o=0;o<n.length;o+=a){const s=n.slice(o,o+a),c=new Array(s.length);for(let f=0;f<s.length;f++)c[f]=s.charCodeAt(f);const l=new Uint8Array(c);r.push(l)}return new Blob(r,{type:e})}const ke=()=>{const t=pe();async function e(){try{const s=(await ee.getLimitedLibraryPhotos()).photos[0];i(s)}catch(s){T.value=""}}async function a(){var s,c;try{const l=await ee.getPhoto({resultType:K.Uri,allowEditing:!0,source:C.Camera,quality:100});if(l){const f={path:(s=l.path)!=null?s:"",webPath:(c=l.webPath)!=null?c:""};return x.value=[f,...x.value],l}}catch(l){x.value=[...x.value]}}async function n(){const s=await a();s&&await i(s)}async function r(s,c){const l=[];return new Promise(f=>{s.forEach(async(h,y)=>{let E;const A=y+Date.now()+".jpeg",D=J(t,"test/".concat(A));if(X("hybrid")){const U=await re.readFile({path:String(h.path)});E=ne(U.data,"image/jpeg")}else E=await(await fetch(String(h.webPath))).blob();const{url:S,upload:F,refresh:W}=await Y(D);if(await F(E),await W(),S.value){const U={image:S.value,authorId:c};l.push(U),y===s.length-1&&setTimeout(()=>{console.log(l),f(l)},800)}})})}async function i(s){try{let c;const l=Date.now()+".jpeg",f=J(t,"test/".concat(l));if(X("hybrid")){const A=await re.readFile({path:s.path});c=ne(A.data,"image/jpeg")}else c=await(await fetch(s.webPath)).blob();const{url:h,upload:y,refresh:E}=await Y(f);await y(c),await E(),h.value&&(T.value=h.value)}catch(c){T.value=""}}function o(){T.value="",x.value=[]}return{photoUrl:T,photosDraft:x,takePhoto:a,takePhotoAndSave:n,savePhotosAndGetImagesPath:r,savePhotoInStorage:i,getPhotoFromLibrary:e,resetPhotos:o}};export{ae as E,V as W,Ce as b,ke as u};
