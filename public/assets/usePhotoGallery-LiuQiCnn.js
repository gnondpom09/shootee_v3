const __vite__fileDeps=["assets/web-iafMOUOc.js","assets/index--va98jub.js","assets/index-D1UOsCVC.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{_ as he,r as z,X as pe,Y as Q,Z as ee,$ as te}from"./index--va98jub.js";/*! Capacitor: https://capacitorjs.com/ - MIT License */const ge=t=>{const e=new Map;e.set("web",{name:"web"});const a=t.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:e},n=(i,o)=>{a.platforms.set(i,o)},r=i=>{a.platforms.has(i)&&(a.currentPlatform=a.platforms.get(i))};return a.addPlatform=n,a.setPlatform=r,a},be=t=>t.CapacitorPlatforms=ge(t),ce=be(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});ce.addPlatform;ce.setPlatform;var S;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(S||(S={}));class F extends Error{constructor(e,a,n){super(e),this.message=e,this.code=a,this.data=n}}const we=t=>{var e,a;return t!=null&&t.androidBridge?"android":!((a=(e=t==null?void 0:t.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||a===void 0)&&a.bridge?"ios":"web"},ve=t=>{var e,a,n,r,i;const o=t.CapacitorCustomPlatform||null,s=t.Capacitor||{},c=s.Plugins=s.Plugins||{},l=t.CapacitorPlatforms,u=()=>o!==null?o.name:we(t),b=((e=l==null?void 0:l.currentPlatform)===null||e===void 0?void 0:e.getPlatform)||u,w=()=>b()!=="web",k=((a=l==null?void 0:l.currentPlatform)===null||a===void 0?void 0:a.isNativePlatform)||w,T=d=>{const f=x.get(d);return!!(f!=null&&f.platforms.has(b())||j(d))},L=((n=l==null?void 0:l.currentPlatform)===null||n===void 0?void 0:n.isPluginAvailable)||T,$=d=>{var f;return(f=s.PluginHeaders)===null||f===void 0?void 0:f.find(O=>O.name===d)},j=((r=l==null?void 0:l.currentPlatform)===null||r===void 0?void 0:r.getPluginHeader)||$,G=d=>t.console.error(d),D=(d,f,O)=>Promise.reject("".concat(O,' does not have an implementation of "').concat(f,'".')),x=new Map,H=(d,f={})=>{const O=x.get(d);if(O)return console.warn('Capacitor plugin "'.concat(d,'" already registered. Cannot register plugins twice.')),O.proxy;const A=b(),R=j(d);let y;const ue=async()=>(!y&&A in f?y=typeof f[A]=="function"?y=await f[A]():y=f[A]:o!==null&&!y&&"web"in f&&(y=typeof f.web=="function"?y=await f.web():y=f.web),y),fe=(m,h)=>{var v,P;if(R){const E=R==null?void 0:R.methods.find(g=>h===g.name);if(E)return E.rtype==="promise"?g=>s.nativePromise(d,h.toString(),g):(g,M)=>s.nativeCallback(d,h.toString(),g,M);if(m)return(v=m[h])===null||v===void 0?void 0:v.bind(m)}else{if(m)return(P=m[h])===null||P===void 0?void 0:P.bind(m);throw new F('"'.concat(d,'" plugin is not implemented on ').concat(A),S.Unimplemented)}},K=m=>{let h;const v=(...P)=>{const E=ue().then(g=>{const M=fe(g,m);if(M){const W=M(...P);return h=W==null?void 0:W.remove,W}else throw new F('"'.concat(d,".").concat(m,'()" is not implemented on ').concat(A),S.Unimplemented)});return m==="addListener"&&(E.remove=async()=>h()),E};return v.toString=()=>"".concat(m.toString(),"() { [capacitor code] }"),Object.defineProperty(v,"name",{value:m,writable:!1,configurable:!1}),v},Y=K("addListener"),Z=K("removeListener"),me=(m,h)=>{const v=Y({eventName:m},h),P=async()=>{const g=await v;Z({eventName:m,callbackId:g},h)},E=new Promise(g=>v.then(()=>g({remove:P})));return E.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await P()},E},N=new Proxy({},{get(m,h){switch(h){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return R?me:Y;case"removeListener":return Z;default:return K(h)}}});return c[d]=N,x.set(d,{name:d,proxy:N,platforms:new Set([...Object.keys(f),...R?[A]:[]])}),N},C=((i=l==null?void 0:l.currentPlatform)===null||i===void 0?void 0:i.registerPlugin)||H;return s.convertFileSrc||(s.convertFileSrc=d=>d),s.getPlatform=b,s.handleError=G,s.isNativePlatform=k,s.isPluginAvailable=L,s.pluginMethodNoop=D,s.registerPlugin=C,s.Exception=F,s.DEBUG=!!s.DEBUG,s.isLoggingEnabled=!!s.isLoggingEnabled,s.platform=s.getPlatform(),s.isNative=s.isNativePlatform(),s},ye=t=>t.Capacitor=ve(t),q=ye(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),B=q.registerPlugin;q.Plugins;class J{constructor(e){this.listeners={},this.retainedEventArguments={},this.windowListeners={},e&&(console.warn('Capacitor WebPlugin "'.concat(e.name,'" config object was deprecated in v3 and will be removed in v4.')),this.config=e)}addListener(e,a){let n=!1;this.listeners[e]||(this.listeners[e]=[],n=!0),this.listeners[e].push(a);const i=this.windowListeners[e];i&&!i.registered&&this.addWindowListener(i),n&&this.sendRetainedArgumentsForEvent(e);const o=async()=>this.removeListener(e,a);return Promise.resolve({remove:o})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,a,n){const r=this.listeners[e];if(!r){if(n){let i=this.retainedEventArguments[e];i||(i=[]),i.push(a),this.retainedEventArguments[e]=i}return}r.forEach(i=>i(a))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,a){this.windowListeners[a]={registered:!1,windowEventName:e,pluginEventName:a,handler:n=>{this.notifyListeners(a,n)}}}unimplemented(e="not implemented"){return new q.Exception(e,S.Unimplemented)}unavailable(e="not available"){return new q.Exception(e,S.Unavailable)}async removeListener(e,a){const n=this.listeners[e];if(!n)return;const r=n.indexOf(a);this.listeners[e].splice(r,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const a=this.retainedEventArguments[e];a&&(delete this.retainedEventArguments[e],a.forEach(n=>{this.notifyListeners(e,n)}))}}const ae=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),re=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class Pe extends J{async getCookies(){const e=document.cookie,a={};return e.split(";").forEach(n=>{if(n.length<=0)return;let[r,i]=n.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");r=re(r).trim(),i=re(i).trim(),a[r]=i}),a}async setCookie(e){try{const a=ae(e.key),n=ae(e.value),r="; expires=".concat((e.expires||"").replace("expires=","")),i=(e.path||"/").replace("path=",""),o=e.url!=null&&e.url.length>0?"domain=".concat(e.url):"";document.cookie="".concat(a,"=").concat(n||"").concat(r,"; path=").concat(i,"; ").concat(o,";")}catch(a){return Promise.reject(a)}}async deleteCookie(e){try{document.cookie="".concat(e.key,"=; Max-Age=0")}catch(a){return Promise.reject(a)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const a of e)document.cookie=a.replace(/^ +/,"").replace(/=.*/,"=;expires=".concat(new Date().toUTCString(),";path=/"))}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}B("CapacitorCookies",{web:()=>new Pe});const Ee=async t=>new Promise((e,a)=>{const n=new FileReader;n.onload=()=>{const r=n.result;e(r.indexOf(",")>=0?r.split(",")[1]:r)},n.onerror=r=>a(r),n.readAsDataURL(t)}),Le=(t={})=>{const e=Object.keys(t);return Object.keys(t).map(r=>r.toLocaleLowerCase()).reduce((r,i,o)=>(r[i]=t[e[o]],r),{})},Ce=(t,e=!0)=>t?Object.entries(t).reduce((n,r)=>{const[i,o]=r;let s,c;return Array.isArray(o)?(c="",o.forEach(l=>{s=e?encodeURIComponent(l):l,c+="".concat(i,"=").concat(s,"&")}),c.slice(0,-1)):(s=e?encodeURIComponent(o):o,c="".concat(i,"=").concat(s)),"".concat(n,"&").concat(c)},"").substr(1):null,Ae=(t,e={})=>{const a=Object.assign({method:t.method||"GET",headers:t.headers},e),r=Le(t.headers)["content-type"]||"";if(typeof t.data=="string")a.body=t.data;else if(r.includes("application/x-www-form-urlencoded")){const i=new URLSearchParams;for(const[o,s]of Object.entries(t.data||{}))i.set(o,s);a.body=i.toString()}else if(r.includes("multipart/form-data")||t.data instanceof FormData){const i=new FormData;if(t.data instanceof FormData)t.data.forEach((s,c)=>{i.append(c,s)});else for(const s of Object.keys(t.data))i.append(s,t.data[s]);a.body=i;const o=new Headers(a.headers);o.delete("content-type"),a.headers=o}else(r.includes("application/json")||typeof t.data=="object")&&(a.body=JSON.stringify(t.data));return a};class Ue extends J{async request(e){const a=Ae(e,e.webFetchExtra),n=Ce(e.params,e.shouldEncodeUrlParams),r=n?"".concat(e.url,"?").concat(n):e.url,i=await fetch(r,a),o=i.headers.get("content-type")||"";let{responseType:s="text"}=i.ok?e:{};o.includes("application/json")&&(s="json");let c,l;switch(s){case"arraybuffer":case"blob":l=await i.blob(),c=await Ee(l);break;case"json":c=await i.json();break;case"document":case"text":default:c=await i.text()}const u={};return i.headers.forEach((b,w)=>{u[w]=b}),{data:c,headers:u,status:i.status,url:i.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}B("CapacitorHttp",{web:()=>new Ue});var U;(function(t){t.Prompt="PROMPT",t.Camera="CAMERA",t.Photos="PHOTOS"})(U||(U={}));var I;(function(t){t.Rear="REAR",t.Front="FRONT"})(I||(I={}));var X;(function(t){t.Uri="uri",t.Base64="base64",t.DataUrl="dataUrl"})(X||(X={}));class de extends J{async getPhoto(e){return new Promise(async(a,n)=>{if(e.webUseInput||e.source===U.Photos)this.fileInputExperience(e,a,n);else if(e.source===U.Prompt){let r=document.querySelector("pwa-action-sheet");r||(r=document.createElement("pwa-action-sheet"),document.body.appendChild(r)),r.header=e.promptLabelHeader||"Photo",r.cancelable=!1,r.options=[{title:e.promptLabelPhoto||"From Photos"},{title:e.promptLabelPicture||"Take Picture"}],r.addEventListener("onSelection",async i=>{i.detail===0?this.fileInputExperience(e,a,n):this.cameraExperience(e,a,n)})}else this.cameraExperience(e,a,n)})}async pickImages(e){return new Promise(async(a,n)=>{this.multipleFileInputExperience(a,n)})}async cameraExperience(e,a,n){if(customElements.get("pwa-camera-modal")){const r=document.createElement("pwa-camera-modal");r.facingMode=e.direction===I.Front?"user":"environment",document.body.appendChild(r);try{await r.componentOnReady(),r.addEventListener("onPhoto",async i=>{const o=i.detail;o===null?n(new F("User cancelled photos app")):o instanceof Error?n(o):a(await this._getCameraPhoto(o,e)),r.dismiss(),document.body.removeChild(r)}),r.present()}catch(i){this.fileInputExperience(e,a,n)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),this.fileInputExperience(e,a,n)}fileInputExperience(e,a,n){let r=document.querySelector("#_capacitor-camera-input");const i=()=>{var o;(o=r.parentNode)===null||o===void 0||o.removeChild(r)};r||(r=document.createElement("input"),r.id="_capacitor-camera-input",r.type="file",r.hidden=!0,document.body.appendChild(r),r.addEventListener("change",o=>{const s=r.files[0];let c="jpeg";if(s.type==="image/png"?c="png":s.type==="image/gif"&&(c="gif"),e.resultType==="dataUrl"||e.resultType==="base64"){const l=new FileReader;l.addEventListener("load",()=>{if(e.resultType==="dataUrl")a({dataUrl:l.result,format:c});else if(e.resultType==="base64"){const u=l.result.split(",")[1];a({base64String:u,format:c})}i()}),l.readAsDataURL(s)}else a({webPath:URL.createObjectURL(s),format:c}),i()}),r.addEventListener("cancel",o=>{n(new F("User cancelled photos app")),i()})),r.accept="image/*",r.capture=!0,e.source===U.Photos||e.source===U.Prompt?r.removeAttribute("capture"):e.direction===I.Front?r.capture="user":e.direction===I.Rear&&(r.capture="environment"),r.click()}multipleFileInputExperience(e,a){let n=document.querySelector("#_capacitor-camera-input-multiple");const r=()=>{var i;(i=n.parentNode)===null||i===void 0||i.removeChild(n)};n||(n=document.createElement("input"),n.id="_capacitor-camera-input-multiple",n.type="file",n.hidden=!0,n.multiple=!0,document.body.appendChild(n),n.addEventListener("change",i=>{const o=[];for(let s=0;s<n.files.length;s++){const c=n.files[s];let l="jpeg";c.type==="image/png"?l="png":c.type==="image/gif"&&(l="gif"),o.push({webPath:URL.createObjectURL(c),format:l})}e({photos:o}),r()}),n.addEventListener("cancel",i=>{a(new F("User cancelled photos app")),r()})),n.accept="image/*",n.click()}_getCameraPhoto(e,a){return new Promise((n,r)=>{const i=new FileReader,o=e.type.split("/")[1];a.resultType==="uri"?n({webPath:URL.createObjectURL(e),format:o,saved:!1}):(i.readAsDataURL(e),i.onloadend=()=>{const s=i.result;a.resultType==="dataUrl"?n({dataUrl:s,format:o,saved:!1}):n({base64String:s.split(",")[1],format:o,saved:!1})},i.onerror=s=>{r(s)})})}async checkPermissions(){if(typeof navigator>"u"||!navigator.permissions)throw this.unavailable("Permissions API not available in this browser");try{return{camera:(await window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch(e){throw this.unavailable("Camera permissions are not available in this browser")}}async requestPermissions(){throw this.unimplemented("Not implemented on web.")}async pickLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}async getLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}}new de;const ne=B("Camera",{web:()=>new de});var se;(function(t){t.Documents="DOCUMENTS",t.Data="DATA",t.Library="LIBRARY",t.Cache="CACHE",t.External="EXTERNAL",t.ExternalStorage="EXTERNAL_STORAGE"})(se||(se={}));var ie;(function(t){t.UTF8="utf8",t.ASCII="ascii",t.UTF16="utf16"})(ie||(ie={}));const oe=B("Filesystem",{web:()=>he(()=>import("./web-iafMOUOc.js"),__vite__mapDeps([0,1,2])).then(t=>new t.FilesystemWeb)}),p=z([]),_=z([]),V=z([]);function le(t,e="",a=512){const n=atob(t),r=[];for(let o=0;o<n.length;o+=a){const s=n.slice(o,o+a),c=new Array(s.length);for(let u=0;u<s.length;u++)c[u]=s.charCodeAt(u);const l=new Uint8Array(c);r.push(l)}return new Blob(r,{type:e})}const xe=()=>{const t=pe();async function e(){try{const s=(await ne.getLimitedLibraryPhotos()).photos[0];i(s)}catch(s){p.value=[...p.value]}}async function a(){try{const s=await ne.getPhoto({resultType:X.Uri,allowEditing:!0,source:U.Camera,quality:100}),l={filepath:Date.now()+".jpeg",webviewPath:s.webPath,photo:s};return _.value=[l,..._.value],s}catch(s){_.value=[..._.value]}}async function n(){const s=await a();s&&await i(s)}async function r(s,c){const l=[];try{s.forEach(async(u,b)=>{var D,x,H;let w;const k=b+Date.now()+".jpeg",T=Q(t,"test/".concat(k)),L={filepath:k,webviewPath:(D=u.photo)==null?void 0:D.webPath};if(ee("hybrid")){const C=await oe.readFile({path:String((x=u.photo)==null?void 0:x.path)});w=le(C.data,"image/jpeg")}else w=await(await fetch(String((H=u.photo)==null?void 0:H.webPath))).blob();const{url:$,upload:j,refresh:G}=await te(T);if(await j(w),await G(),$.value){L.webviewPath=$.value;const C={image:$.value,authorId:c};l.push(C),p.value=[L,...p.value],V.value=[C,...V.value]}})}catch(u){p.value=[...p.value]}finally{return l}}async function i(s){try{let c;const l=Date.now()+".jpeg",u={filepath:l,webviewPath:s.webPath},b=Q(t,"test/".concat(l));if(ee("hybrid")){const L=await oe.readFile({path:s.path});c=le(L.data,"image/jpeg")}else c=await(await fetch(s.webPath)).blob();const{url:w,upload:k,refresh:T}=await te(b);await k(c),await T(),w.value&&(u.webviewPath=w.value),p.value=[u,...p.value]}catch(c){p.value=[...p.value]}}function o(){p.value=[],_.value=[]}return{photos:p,photosDraft:_,photosSaved:V,takePhoto:a,takePhotoAndSave:n,savePhotosAndGetImagesPath:r,savePhotoInStorage:i,getPhotoFromLibrary:e,resetPhotos:o}};export{ie as E,J as W,Ae as b,xe as u};
